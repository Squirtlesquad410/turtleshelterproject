<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maintain Users</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Reset some default styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Body styling */
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(45deg, #ff7b7b, #ff8c00, #fbbd61);
            background-size: 300% 300%;
            animation: gradientAnimation 8s ease infinite;
            height: 100vh;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            transition: all 0.3s ease-in-out;
        }

        /* Header styling */
        h1 {
            font-size: 3.5em;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 100px;
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.4);
        }

        /* Paragraph styling */
        p {
            font-size: 1.2em;
            font-weight: 500;
            line-height: 1.6;
            margin-top: 20px;
            color: #f7f7f7;
            text-shadow: 1px 1px 8px rgba(0, 0, 0, 0.2);
        }

        /* Button styling */
        .btn {
            margin-top: 30px;
            padding: 15px 30px;
            background-color: #ff5733;
            color: white;
            font-size: 1.2em;
            border-radius: 50px;
            text-transform: uppercase;
            font-weight: 600;
            border: none;
            cursor: pointer;
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .btn:hover {
            background-color: #ff3e1d;
            transform: scale(1.05);
        }

        /* Animation for gradient background */
        @keyframes gradientAnimation {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

    </style>
</head>
<body>
    <%- include('partials/navbar') %>
    <br>
    <h1>Volunteer Information:</h1>
    <!--INSERT CODE HERE TO ALLOW YOU TO VIEW OUR LIVE DATABASE
    OF USERS, PROVIDE AN EDIT AND DELETE USER BUTON IN THE TABLE

    ALSO, PROVIDE AN ADD BUTTON BELOW THE TABLE
        (This is like the exact same thing we did for Test 2)-->
    <form method="GET" action="/maintain-volunteers" class="filter-form">

            <label for="first_name">First Name</label>
            <input type="text" id="first_name" name="vol_first_name" placeholder="First Name" value="<%= first_nameFilter || '' %>">
        
            <label for="last_name">Last Name</label>
            <input type="text" id="last_name" name="vol_last_name" placeholder="Last Name" value="<%= last_nameFilter || '' %>">
        
            <label for="city">City:</label>
            <input type="text" id="city" name="city" placeholder="City" value="<%= cityFilter || '' %>">
        
            <button type="submit">Apply Filters</button>
        </form>
                <table>
                    <thead>
                        <tr>
                            <th>First Name</th>
                            <th>Last Name</th>
                            <th>City</th>
                            <th>Email</th>
                            <th>Willing to Teach Sewing</th>
                            <th>Willing to Lead</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% volunteers.forEach(volunteer => { %>
                            <!-- Main Row -->
                            <tr class="clickable-row" data-id="<%= volunteer.vol_id %>">
                                <td><%= volunteer.vol_first_name %></td>
                                <td><%= volunteer.vol_last_name %></td>
                                <td><%= volunteer.city %></td>
                                <td><%= volunteer.vol_email %></td>
                                <td><%= volunteer.willing_to_teach_sewing %></td>
                                <td><%= volunteer.willing_to_lead %></td>
                                <td>
                                    <form action="/edit-volunteer/<%= volunteer.vol_id %>" method="GET" style="display:inline;">
                                        <button type="submit">Edit</button>
                                      </form>
                                      <form action="/delete-volunteer/<%= volunteer.vol_id %>" method="POST" style="display:inline;">
                                        <button type="submit" onclick="return confirm('Are you sure you want to delete this record?');">Delete</button>
                                      </form>
                                      <form action="/send-email/<%= volunteer.vol_id %>" method="GET" style="display:inline;"">
                                        <button type="submit">Email</button>
                                      </form>
                                </td>
                            </tr>
                            <!-- Hidden Details Row -->
                            <tr class="details-row" id="details-<%= volunteer.vol_id %>" style="display: none;">
                                <td colspan="5">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td><strong>Phone</strong></td>
                                                <td><%= volunteer.vol_phone %></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Sewing Ability</strong></td>
                                                <td><%= volunteer.sewing_ability_description %></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Finding_Source</strong></td>
                                                <td><%= volunteer.finding_source %></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Monthly Hours Available:</strong></td>
                                                <td><%= volunteer.monthly_hours_available %></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Volunteer ID:</strong></td>
                                                <td><%= volunteer.vol_id %></td>
                                            </tr>
                                            
                                
                                        </tbody>
                                    </table>
                                </td>
                            </tr>
                        <% }) %>
                    </tbody>
                </table>
                
                <script>
                    document.addEventListener('DOMContentLoaded', () => {
                        // Attach click event to rows
                        document.querySelectorAll('.clickable-row').forEach(row => {
                            row.addEventListener('click', (e) => {
                                // Prevent the click from triggering when clicking buttons
                                if (e.target.tagName === 'BUTTON') return;
                
                                const volunteerId = row.getAttribute('data-id');
                                const detailsRow = document.getElementById(`details-${volunteerId}`);
                                
                                // Toggle display
                                if (detailsRow.style.display === 'none') {
                                    detailsRow.style.display = '';
                                } else {
                                    detailsRow.style.display = 'none';
                                }
                            });
                        });
                    });
                
                    // Edit handler (to be implemented)
                    function handleEdit(eventId) {
                        window.location.href = `/edit-volunteer/${volunteerId}`; // Adjust route as needed
                    }
                
                    // Delete handler (with confirmation)
                    function handleDelete(eventId) {
                        if (confirm("Are you sure you want to delete this volunteer?")) {
                            fetch(`/delete-volunteer/${volunteerId}`, { method: 'DELETE' })
                                .then(response => {
                                    if (response.ok) {
                                        alert("Volunteer deleted successfully!");
                                        location.reload(); // Reload the page to reflect changes
                                    } else {
                                        alert("Failed to delete volunteer.");
                                    }
                                });
                        }
                    }
                </script>
                
                
                <!-- Pagination Controls -->
                <div class="pagination">
                    <% if (currentPage > 1) { %>
                        <a href="/maintain-volunteers?page=<%= currentPage - 1 %>">Previous</a>
                    <% } %>
                
                    <% for (let i = 1; i <= totalPages; i++) { %>
                        <a href="/maintain-volunteers?page=<%= i %>" 
                           class="<%= i === currentPage ? 'active' : '' %>"><%= i %></a>
                    <% } %>
                
                    <% if (currentPage < totalPages) { %>
                        <a href="/maintain-volunteers?page=<%= currentPage + 1 %>">Next</a>
                    <% } %>
                </div>
                
                <!-- Button to add a new volunteer -->
                <div>
                    <a href="/volunteer"><button>Add New Volunteer</button></a>
                </div>
    
    <br><br>
</body>
</html>